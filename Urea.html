<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مونوگراف اوره (USP)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet">
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f8f9fa;
            line-height: 1.6;
            word-spacing: normal;
            letter-spacing: normal;
        }
        .tab-active { border-color: #3b82f6; color: #3b82f6; background-color: #eff6ff; }
        .tab-inactive { border-color: transparent; color: #6b7280; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-right: auto; margin-left: auto; height: 350px; max-height: 40vh; }
        table {
            direction: rtl;
            text-align: right;
        }
        th {
            text-align: right;
            vertical-align: top;
        }
        td {
            text-align: right;
            vertical-align: middle;
        }

        /* Specific override for the results column in COA */
        #coa-results-table-body td:last-child {
            text-align: left !important;
            direction: ltr;
        }
        /* Specific override for the 'نتایج' header in COA */
        #coa-content-to-pdf table thead th:last-child {
            text-align: left !important;
        }
        /* Ensure vertical alignment for all headers in COA table */
        #coa-content-to-pdf table thead th {
            vertical-align: top !important;
        }

        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            line-height: inherit;
            word-spacing: inherit;
            letter-spacing: inherit;
            white-space: normal;
        }
        .ltr-text {
            direction: ltr;
            display: inline-block;
            unicode-bidi: isolate;
        }
        .math-input {
            appearance: none;
            -moz-appearance: textfield;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            width: 100px;
            text-align: left;
            direction: ltr;
        }
        .math-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        #coa-content-to-pdf {
            direction: ltr;
            text-align: left;
            padding: 1.5rem;
        }
        #coa-content-to-pdf p,
        #coa-content-to-pdf h1,
        #coa-content-to-pdf h2,
        #coa-content-to-pdf h3,
        #coa-content-to-pdf th,
        #coa-content-to-pdf td,
        #coa-content-to-pdf label {
            font-family: 'Vazirmatn', sans-serif;
            line-height: 1.6;
            word-spacing: normal;
            letter-spacing: normal;
            white-space: normal;
            padding-top: 0.25rem;
            padding-bottom: 0.25rem;
        }
        #coa-content-to-pdf input[type="text"],
        #coa-content-to-pdf input[type="date"] {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            min-height: 2.8rem;
            box-sizing: border-box;
        }
        .grid.grid-cols-1.md\:grid-cols-2.gap-4.mb-6.text-gray-700.text-sm .flex.items-center.gap-2 {
            align-items: flex-start;
        }
        .grid.grid-cols-1.md\:grid-cols-3.gap-4.mb-6.text-gray-700.text-sm .flex.flex-col.items-center {
            min-height: 5rem;
            justify-content: flex-start;
        }
        .grid.grid-cols-1.md\:grid-cols-3.gap-4.mb-6.text-gray-700.text-sm input[type="text"] {
            min-height: 2.8rem;
        }
        #coa-results-table-body td, #coa-results-table-body th {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            box-sizing: border-box;
        }
        #coa-content-to-pdf table th {
            border: none;
            padding-top: 1rem;
            padding-bottom: 1rem;
            font-size: 0.95rem;
            font-weight: 700;
            background-color: #e5e7eb;
        }
        #coa-content-to-pdf table td {
            border: none;
        }
        #coa-content-to-pdf table {
            border-collapse: collapse;
        }

        /* Specific LTR styles for the COA tab's table */
        #coa-content-to-pdf table {
            direction: ltr; /* Ensure the entire table is LTR */
            text-align: left; /* Align general table content to left */
        }

        #coa-content-to-pdf table thead th {
            text-align: left; /* Align headers to the left within LTR table */
            direction: ltr; /* Explicitly set LTR for headers */
        }

        #coa-results-table-body td:first-child, /* Target the first column (Tests) */
        #coa-results-table-body td:nth-child(2) { /* Target the second column (Specification) */
            text-align: left; /* Align body cells to the left within LTR table */
            direction: ltr; /* Explicitly set LTR for body cells */
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">مونوگراف اوره (USP)</h1>
            <p class="mt-2 text-lg text-gray-600">بررسی مشخصات دارویی طبق مونوگراف USP</p>
        </header>

        <nav class="mb-8 bg-white p-2 rounded-xl shadow-sm">
            <div class="flex justify-center border-b border-gray-200 flex-wrap">
                <button data-tab="definition" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-active">تعریف</button>
                <button data-tab="identification" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">شناسایی</button>
                <button data-tab="assay" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">سنجش</button>
                <button data-tab="impurities" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">ناخالصی‌ها</button>
                <button data-tab="specific-tests" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">آزمایشات خاص</button>
                <button data-tab="additional-requirements" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">الزامات اضافی</button>
                <button data-tab="coa" class="tab-button text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 tab-inactive">COA</button>
            </div>
        </nav>

        <main>
            <div id="definition" class="tab-content space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">تعریف اوره</h2>
                    <p class="text-gray-600 mb-6">این بخش شامل تعریف اوره و مقادیر مجاز آن است.</p>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold mb-4">تعریف</h3>
                    <p class="text-gray-700 mb-4">اوره حاوی حداقل <span class="ltr-text">98.0%</span> و حداکثر <span class="ltr-text">102.0%</span> اوره (<span class="ltr-text">$CH_{4}N_{2}O$</span>) است.</p>
                    <p class="text-gray-700 mt-4">نام شیمیایی: اوره؛ کاربامید <span class="ltr-text">[57-13-6]</span>.</p>
                    <p class="text-gray-700">فرمول شیمیایی: <span class="ltr-text">$CH_{4}N_{2}O$</span></p>
                    <p class="text-gray-700">وزن مولکولی: <span class="ltr-text">60.06</span></p>
                </div>
            </div>

            <div id="identification" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">شناسایی</h2>
                    <p class="text-gray-600 mb-6">این بخش شامل معیارهای شناسایی اوره است.</p>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold mb-4">آزمایشات شناسایی</h3>
                    <ul class="space-y-3 list-disc list-inside text-gray-700">
                        <li><span class="font-bold">A. آزمایشات شناسایی طیف‌سنجی (<a href="General chapters/〈197〉 SPECTROSCOPIC IDENTIFICATION TESTS.pdf" class="text-blue-600 hover:underline" target="_blank">197</a>)، طیف‌سنجی فروسرخ:</span> <span class="ltr-text">197K_{A}</span></li>
                        <li><span class="font-bold">B.</span> زمان نگهداری پیک اصلی محلول نمونه با زمان نگهداری محلول استاندارد، همانطور که در سنجش به دست آمده است، مطابقت دارد.</li>
                    </ul>
                </div>
            </div>

            <div id="assay" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">سنجش</h2>
                    <p class="text-gray-600 mb-6">این بخش جزئیات روش سنجش برای تعیین مقدار اوره (<span class="ltr-text">$CH_{4}N_{2}O$</span>) را توضیح می‌دهد. می‌توانید مقادیر را برای محاسبه درصد وارد کنید.</p>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold mb-4">روش کار:</h3>
                    <p class="text-gray-700 mb-4">محلول A: <span class="ltr-text">1 mL</span> اسید فرمیک را به یک فلاسک حجمی <span class="ltr-text">1-L</span> منتقل کنید و با آب به حجم برسانید.</p>
                    <p class="text-gray-700 mb-4">محلول B: <span class="ltr-text">100%</span> استونیتریل، از فیلتر غشایی با اندازه منافذ <span class="ltr-text">0.2-µm</span> عبور داده شده است.</p>
                    <p class="text-gray-700 mb-4">فاز متحرک: به جدول 1 مراجعه کنید.</p>
                    <div class="overflow-x-auto mb-4">
                        <table class="min-w-full bg-white border border-gray-200 text-center">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">زمان (min)</th>
                                    <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">محلول A (%)</th>
                                    <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">محلول B (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="py-2 px-3"><span class="ltr-text">0.0</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">2.5</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">97.5</span></td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-3"><span class="ltr-text">7.0</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">90.0</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">10.0</span></td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-3"><span class="ltr-text">7.01</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">2.5</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">97.5</span></td>
                                </tr>
                                <tr>
                                    <td class="py-2 px-3"><span class="ltr-text">15.0</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">2.5</span></td>
                                    <td class="py-2 px-3"><span class="ltr-text">97.5</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <p class="text-gray-700 mb-4"><span class="font-bold">رقیق‌کننده:</span> استونیتریل و آب (<span class="ltr-text">90:10</span>)</p>
                    <p class="text-gray-700 mb-4"><span class="font-bold">محلول مناسب سیستم:</span> <span class="ltr-text">0.01 mg/mL</span> از <span class="ltr-text">USP Urea Related Compound A RS</span> و <span class="ltr-text">10 mg/mL</span> از <span class="ltr-text">USP Urea RS</span> در رقیق‌کننده.</p>
                    <p class="text-gray-700 mb-4"><span class="font-bold">محلول استاندارد:</span> <span class="ltr-text">5 mg/mL</span> از <span class="ltr-text">USP Urea RS</span> در رقیق‌کننده.</p>
                    <p class="text-gray-700 mb-4"><span class="font-bold">محلول نمونه:</span> <span class="ltr-text">5 mg/mL</span> اوره در رقیق‌کننده.</p>
                    <p class="text-gray-700 mb-2"><span class="font-bold">سیستم کروماتوگرافی:</span> (به کروماتوگرافی (<a href="General chapters/〈621〉 CHROMATOGRAPHY.pdf" class="text-blue-600 hover:underline" target="_blank">621</a>)، مناسب بودن سیستم مراجعه کنید.)</p>
                    <ul class="list-circle list-inside ml-5">
                        <li>حالت: <span class="ltr-text">LC</span></li>
                        <li>آشکارساز: <span class="ltr-text">UV 195 nm</span></li>
                        <li>ستون: <span class="ltr-text">15-cm × 4.6-mm</span>؛ بسته‌بندی <span class="ltr-text">2.7-µm L86</span></li>
                        <li>دمای ستون: <span class="ltr-text">30°C</span></li>
                        <li>نرخ جریان: <span class="ltr-text">1 mL/min</span></li>
                        <li>حجم تزریق: <span class="ltr-text">2 µL</span></li>
                    </ul>
                    <p class="text-gray-700 mb-2"><span class="font-bold">مناسب بودن سیستم:</span></p>
                    <ul class="list-circle list-inside ml-5">
                        <li>نمونه: محلول مناسب سیستم</li>
                        <li>[توجه—زمان‌های نگهداری نسبی برای ترکیب A مرتبط با اوره و اوره به ترتیب <span class="ltr-text">0.9</span> و <span class="ltr-text">1.0</span> است.]</li>
                        <li>الزامات مناسب بودن:</li>
                        <ul class="list-circle list-inside ml-5">
                            <li>تفکیک: <span class="ltr-text">NLT 1.5</span> بین اوره مرتبط با ترکیب A و اوره</li>
                            <li>انحراف استاندارد نسبی: <span class="ltr-text">NMT 1.0%</span> برای اوره</li>
                        </ul>
                    </ul>
                    <p class="text-gray-700 mb-4"><span class="font-bold">تجزیه و تحلیل:</span></p>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 mb-6">
                        <li>نمونه‌ها: محلول استاندارد و محلول نمونه</li>
                    </ul>
                    <p class="text-gray-700 mb-4">درصد اوره (<span class="ltr-text">$CH_{4}N_{2}O$</span>) را در بخش اوره گرفته شده محاسبه کنید:</p>
                    <p class="font-mono text-center text-lg mb-4">$$Result = (r_{u}/r_{s}) \times (C_{s}/C_{u}) \times 100$$</p>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 mb-6">
                        <li>$r_{u}$ = پاسخ پیک از محلول نمونه</li>
                        <li>$r_{s}$ = پاسخ پیک از محلول استاندارد</li>
                        <li>$C_{s}$ = غلظت <span class="ltr-text">USP Urea RS</span> در محلول استاندارد (<span class="ltr-text">mg/mL</span>)</li>
                        <li>$C_{u}$ = غلظت اوره در محلول نمونه (<span class="ltr-text">mg/mL</span>)</li>
                    </ul>
                    <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm">
                        <div class="math-input-group">
                            <label for="ureaRu">\(r_{u}\):</label>
                            <input class="math-input" id="ureaRu" type="number" value="">
                        </div>
                        <div class="math-input-group">
                            <label for="ureaRs">\(r_{s}\):</label>
                            <input class="math-input" id="ureaRs" type="number" value="">
                        </div>
                        <div class="math-input-group">
                            <label for="ureaCs">\(C_{s}\):</label>
                            <input class="math-input" id="ureaCs" type="number" value="">
                        </div>
                        <div class="math-input-group">
                            <label for="ureaCu">\(C_{u}\):</label>
                            <input class="math-input" id="ureaCu" type="number" value="">
                        </div>
                        <button onclick="calculateUreaAssay()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mt-4">محاسبه سنجش اوره</button>
                    </div>
                    <div class="text-center mt-4">
                        <p class="text-gray-700">نتیجه سنجش اوره: <span id="ureaAssayResult" class="font-bold text-blue-700">--</span>%</p>
                    </div>
                    <p class="text-gray-700 mt-4">معیار پذیرش: <span class="ltr-text">98.0%-102.0%</span></p>
                </div>
            </div>

            <div id="impurities" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">ناخالصی‌ها</h2>
                    <p class="text-gray-600 mb-6">این بخش شامل آزمایشات مربوط به ناخالصی‌ها در اوره است.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">باقی‌مانده پس از احتراق (<a href="General chapters/〈281〉 RESIDUE ON IGNITION.pdf" class="text-blue-600 hover:underline" target="_blank">281</a>)</h3>
                        <p class="text-gray-700">معیار پذیرش: <span class="ltr-text">NMT 0.1%</span></p>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm mt-4">
                            <div class="math-input-group">
                                <label for="roiInput">نتیجه باقی‌مانده پس از احتراق:</label>
                                <select class="math-input" id="roiInput" onchange="updateCOAImpurityResult('residueOnIgnition', this.value)">
                                    <option value="">---</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">ناخالصی‌های آلی</h3>
                        <p class="text-gray-700 mb-4">محلول A، محلول B، فاز متحرک، رقیق‌کننده و سیستم کروماتوگرافی: طبق دستورالعمل سنجش عمل کنید.</p>
                        <p class="text-gray-700 mb-4"><span class="font-bold">محلول مناسب سیستم:</span> <span class="ltr-text">0.01 mg/mL</span> از <span class="ltr-text">USP Urea Related Compound A RS</span> و <span class="ltr-text">10 mg/mL</span> از <span class="ltr-text">USP Urea RS</span> در رقیق‌کننده.</p>
                        <p class="text-gray-700 mb-4"><span class="font-bold">محلول استاندارد:</span> <span class="ltr-text">0.01 mg/mL</span> از <span class="ltr-text">USP Urea RS</span> و <span class="ltr-text">0.01 mg/mL</span> از <span class="ltr-text">USP Urea Related Compound A RS</span> در رقیق‌کننده.</p>
                        <p class="text-gray-700 mb-4"><span class="font-bold">محلول نمونه:</span> <span class="ltr-text">10 mg/mL</span> اوره در رقیق‌کننده.</p>
                        <p class="text-gray-700 mb-2"><span class="font-bold">مناسب بودن سیستم:</span></p>
                        <ul class="list-circle list-inside ml-5">
                            <li>نمونه: محلول مناسب سیستم</li>
                            <li>[توجه—برای زمان‌های نگهداری نسبی، به جدول 2 مراجعه کنید.]</li>
                            <li>الزامات مناسب بودن:</li>
                            <ul class="list-circle list-inside ml-5">
                                <li>تفکیک: <span class="ltr-text">NLT 1.5</span> بین اوره و اوره مرتبط با ترکیب A</li>
                                <li>انحراف استاندارد نسبی: <span class="ltr-text">NMT 1.0%</span> برای اوره</li>
                            </ul>
                        </ul>
                        <p class="text-gray-700 mb-4"><span class="font-bold">تجزیه و تحلیل:</span></p>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 mb-6">
                            <li>نمونه‌ها: محلول استاندارد و محلول نمونه</li>
                        </ul>
                        <p class="text-gray-700 mb-4">درصد اوره مرتبط با ترکیب A را در بخش اوره گرفته شده محاسبه کنید:</p>
                        <p class="font-mono text-center text-lg mb-4">$$Result = (r_{u}/r_{s}) \times (C_{s}/C_{u}) \times 100$$</p>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 mb-6">
                            <li>$r_{u}$ = پاسخ پیک اوره مرتبط با ترکیب A از محلول نمونه</li>
                            <li>$r_{s}$ = پاسخ پیک اوره مرتبط با ترکیب A از محلول استاندارد</li>
                            <li>$C_{s}$ = غلظت <span class="ltr-text">USP Urea Related Compound A RS</span> در محلول استاندارد (<span class="ltr-text">mg/mL</span>)</li>
                            <li>$C_{u}$ = غلظت اوره در محلول نمونه (<span class="ltr-text">mg/mL</span>)</li>
                        </ul>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm">
                            <div class="math-input-group">
                                <label for="ureaRelatedRu">\(r_{u}\):</label>
                                <input class="math-input" id="ureaRelatedRu" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="ureaRelatedRs">\(r_{s}\):</label>
                                <input class="math-input" id="ureaRelatedRs" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="ureaRelatedCs">\(C_{s}\):</label>
                                <input class="math-input" id="ureaRelatedCs" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="ureaRelatedCu">\(C_{u}\):</label>
                                <input class="math-input" id="ureaRelatedCu" type="number" value="">
                            </div>
                            <button onclick="calculateUreaRelatedCompoundA()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mt-4">محاسبه ترکیب A مرتبط با اوره</button>
                        </div>
                        <div class="text-center mt-4">
                            <p class="text-gray-700">نتیجه ترکیب A مرتبط با اوره: <span id="ureaRelatedResult" class="font-bold text-blue-700">--</span>%</p>
                        </div>
                        <p class="text-gray-700 mt-4">درصد هر ناخالصی نامشخص جداگانه را در بخش اوره گرفته شده محاسبه کنید:</p>
                        <p class="font-mono text-center text-lg mb-4">$$Result = (r_{u}/r_{s}) \times (C_{s}/C_{u}) \times 100$$</p>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 mb-6">
                            <li>$r_{u}$ = پاسخ پیک هر ناخالصی از محلول نمونه</li>
                            <li>$r_{s}$ = پاسخ پیک اوره از محلول استاندارد</li>
                            <li>$C_{s}$ = غلظت <span class="ltr-text">USP Urea RS</span> در محلول استاندارد (<span class="ltr-text">mg/mL</span>)</li>
                            <li>$C_{u}$ = غلظت اوره در محلول نمونه (<span class="ltr-text">mg/mL</span>)</li>
                        </ul>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm">
                            <div class="math-input-group">
                                <label for="unspecifiedRu">\(r_{u}\):</label>
                                <input class="math-input" id="unspecifiedRu" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="unspecifiedRs">\(r_{s}\):</label>
                                <input class="math-input" id="unspecifiedRs" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="unspecifiedCs">\(C_{s}\):</label>
                                <input class="math-input" id="unspecifiedCs" type="number" value="">
                            </div>
                            <div class="math-input-group">
                                <label for="unspecifiedCu">\(C_{u}\):</label>
                                <input class="math-input" id="unspecifiedCu" type="number" value="">
                            </div>
                            <button onclick="calculateUnspecifiedImpurity()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mt-4">محاسبه ناخالصی نامشخص</button>
                        </div>
                        <div class="text-center mt-4">
                            <p class="text-gray-700">نتیجه ناخالصی نامشخص: <span id="unspecifiedImpurityResult" class="font-bold text-blue-700">--</span>%</p>
                        </div>
                        <p class="text-gray-700 mt-4">معیار پذیرش: به جدول 2 مراجعه کنید. هر پیک ناخالصی کمتر از <span class="ltr-text">0.05%</span> را نادیده بگیرید.</p>
                        <div class="overflow-x-auto mb-4">
                            <table class="min-w-full bg-white border border-gray-200 text-center">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">نام</th>
                                        <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">زمان نگهداری نسبی</th>
                                        <th class="py-2 px-3 font-bold text-sm text-gray-600 uppercase tracking-wider">معیار پذیرش، NMT (%)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="py-2 px-3">اوره مرتبط با ترکیب A</td>
                                        <td class="py-2 px-3"><span class="ltr-text">0.9</span></td>
                                        <td class="py-2 px-3"><span class="ltr-text">0.1</span></td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-3">اوره</td>
                                        <td class="py-2 px-3"><span class="ltr-text">1.0</span></td>
                                        <td class="py-2 px-3"></td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-3">هر ناخالصی نامشخص جداگانه</td>
                                        <td class="py-2 px-3"></td>
                                        <td class="py-2 px-3"><span class="ltr-text">0.1</span></td>
                                    </tr>
                                    <tr>
                                        <td class="py-2 px-3">کل ناخالصی‌ها</td>
                                        <td class="py-2 px-3"></td>
                                        <td class="py-2 px-3"><span class="ltr-text">2.0</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm mt-4">
                            <div class="math-input-group">
                                <label for="organicImpuritiesInput">نتیجه ناخالصی‌های آلی:</label>
                                <select class="math-input" id="organicImpuritiesInput" onchange="updateCOAImpurityResult('organicImpurities', this.value)">
                                    <option value="">---</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="specific-tests" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">آزمایشات خاص</h2>
                    <p class="text-gray-600 mb-6">این بخش شامل آزمایشات خاصی است که برای اطمینان از کیفیت و خلوص اوره انجام می‌شود.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">ماده نامحلول در الکل</h3>
                        <ul class="space-y-3 list-disc list-inside text-gray-700">
                            <li>محلول نمونه: <span class="ltr-text">100 mg/mL</span> اوره حل شده در الکل گرم.</li>
                            <li>تجزیه و تحلیل: اگر هرگونه باقیمانده نامحلول باقی بماند، محلول نمونه را از یک فیلتر وزن شده (<span class="ltr-text">tared filter</span>) عبور دهید، باقیمانده و فیلتر را با <span class="ltr-text">20 mL</span> الکل گرم به ازای هر <span class="ltr-text">50 mL</span> از محلول نمونه بشویید و در دمای <span class="ltr-text">105°C</span> به مدت <span class="ltr-text">1 h</span> خشک کنید.</li>
                            <li>معیار پذیرش: <span class="ltr-text">NMT 2 mg (0.04%)</span></li>
                        </ul>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm mt-4">
                            <div class="math-input-group">
                                <label for="alcoholInsolubleInput">نتیجه ماده نامحلول در الکل:</label>
                                <select class="math-input" id="alcoholInsolubleInput" onchange="updateCOAImpurityResult('alcoholInsoluble', this.value)">
                                    <option value="">---</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">آزمایشات استریلیته (<a href="General chapters/〈71〉 STERILITY TESTS.pdf" class="text-blue-600 hover:underline" target="_blank">71</a>)</h3>
                        <p class="text-gray-700">در جایی که برچسب بیان می‌کند که اوره استریل است، الزامات را برآورده می‌کند.</p>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm mt-4">
                            <div class="math-input-group">
                                <label for="sterilityTestsInput">نتیجه آزمایشات استریلیته:</label>
                                <select class="math-input" id="sterilityTestsInput" onchange="updateCOAImpurityResult('sterilityTests', this.value)">
                                    <option value="">---</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">آزمایش اندوتوکسین باکتریایی (<a href="General chapters/〈85〉 BACTERIAL ENDOTOXINS TEST.pdf" class="text-blue-600 hover:underline" target="_blank">85</a>)</h3>
                        <p class="text-gray-700">در جایی که برچسب بیان می‌کند که اوره باید در طول تهیه اشکال دوز تزریقی تحت پردازش بیشتر قرار گیرد، حاوی <span class="ltr-text">NMT 0.003 USP Endotoxin Units/mg</span> اوره است.</p>
                        <div class="flex flex-col gap-2 justify-center items-center text-gray-700 text-sm mt-4">
                            <div class="math-input-group">
                                <label for="bacterialEndotoxinsInput">نتیجه آزمایش اندوتوکسین باکتریایی:</label>
                                <select class="math-input" id="bacterialEndotoxinsInput" onchange="updateCOAImpurityResult('bacterialEndotoxins', this.value)">
                                    <option value="">---</option>
                                    <option value="Pass">Pass</option>
                                    <option value="Fail">Fail</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="additional-requirements" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">الزامات اضافی</h2>
                    <p class="text-gray-600 mb-6">این بخش شامل اطلاعات مهم در مورد بسته‌بندی، نگهداری و برچسب‌گذاری اوره است.</p>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold mb-4">بسته‌بندی و نگهداری</h3>
                    <ul class="space-y-3 list-disc list-inside text-gray-700">
                        <li>در ظروف محکم نگهداری شود.</li>
                        <li>در دمای <span class="ltr-text">25°C</span> نگهداری شود، با نوسانات مجاز بین <span class="ltr-text">15°C</span> و <span class="ltr-text">30°C</span>.</li>
                    </ul>
                    <h3 class="text-xl font-bold mb-4 mt-6">برچسب‌گذاری</h3>
                    <ul class="space-y-3 list-disc list-inside text-gray-700">
                        <li>در جایی که برای استفاده در تهیه اشکال دوز تزریقی در نظر گرفته شده است، برچسب بیان می‌کند که استریل است یا باید در طول تهیه اشکال دوز تزریقی تحت پردازش بیشتر قرار گیرد.</li>
                    </ul>
                    <h3 class="text-xl font-bold mb-4 mt-6">استانداردهای مرجع USP (<a href="General chapters/〈11〉 USP REFERENCE STANDARDS.pdf" class="text-blue-600 hover:underline" target="_blank">11</a>)</h3>
                    <ul class="space-y-3 list-disc list-inside text-gray-700">
                        <li><span class="ltr-text">USP Urea RS</span></li>
                        <li><span class="ltr-text">USP Urea Related Compound A RS</span></li>
                    </ul>
                </div>
            </div>

            <div id="coa" class="tab-content hidden space-y-8">
                <div class="card">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">Certificate of Analysis (COA)</h2>
                    <p class="text-gray-600 mb-6">This section summarizes the results of tests and calculations performed according to the monograph.</p>
                </div>
                <div class="card" id="coa-content-to-pdf" dir="ltr">
                    <h3 class="text-xl font-bold mb-4">Product Information</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-gray-700 text-sm">
                        <div class="flex items-center gap-2">
                            <label for="coaProductName" class="font-bold">Product Name:</label>
                            <span id="coaProductNameDisplay" class="w-full p-2 border border-gray-300 rounded-md bg-gray-100 text-gray-700">Urea</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="coaBatchNumber" class="font-bold">Batch Number:</label>
                            <input type="text" id="coaBatchNumber" class="w-full p-2 border border-gray-300 rounded-md" value="">
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="coaMfgDate" class="font-bold">Mfg. Date:</label>
                            <input type="date" id="coaMfgDate" class="w-full p-2 border border-gray-300 rounded-md" value="">
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="coaProductCode" class="font-bold">Product Code:</label>
                            <input type="text" id="coaProductCode" class="w-full p-2 border border-gray-300 rounded-md" value="">
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="coaRetestDate" class="font-bold">Retest Date:</label>
                            <input type="date" id="coaRetestDate" class="w-full p-2 border border-gray-300 rounded-md" value="">
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="coaAnalysisNumber" class="font-bold">Analysis Number:</label>
                            <input type="text" id="coaAnalysisNumber" class="w-full p-2 border border-gray-300 rounded-md" value="">
                        </div>
                    </div>

                    <h3 class="text-xl font-bold mb-4">Test Results</h3>
                    <div class="overflow-x-auto mb-6">
                        <table class="min-w-full bg-white border border-gray-200">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="py-3 px-4 font-bold text-sm text-gray-600 uppercase tracking-wider text-left">Tests</th>
                                    <th class="py-3 px-4 font-bold text-sm text-gray-600 uppercase tracking-wider text-left">Specification (USP)</th>
                                    <th class="py-3 px-4 font-bold text-sm text-gray-600 uppercase tracking-wider text-left">Results</th>
                                </tr>
                            </thead>
                            <tbody id="coa-results-table-body">
                            </tbody>
                        </table>
                    </div>

                    <h3 class="text-xl font-bold mb-4">Signatures</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-gray-700 text-sm">
                        <div class="flex flex-col items-center">
                            <label for="coaAnalyst" class="font-bold mb-1">Analyst:</label>
                            <input type="text" id="coaAnalyst" class="w-full p-2 border border-gray-300 rounded-md text-center" value="">
                        </div>
                        <div class="flex flex-col items-center">
                            <label for="coaSupervisor" class="font-bold mb-1">QC Lab Supervisor:</label>
                            <input type="text" id="coaSupervisor" class="w-full p-2 border border-gray-300 rounded-md text-center" value="">
                        </div>
                        <div class="flex flex-col items-center">
                            <label for="coaQCManager" class="font-bold mb-1">QC Manager:</label>
                            <input type="text" id="coaQCManager" class="w-full p-2 border border-gray-300 rounded-md text-center" value="">
                        </div>
                    </div>

                    <div class="flex justify-center">
                        <button onclick="exportCOAPDF()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded mt-4">Save COA as PDF</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Object to store calculation results for COA
        let calculationResults = {
            ureaAssay: { label: 'Urea Assay', value: '--', unit: '%', status: 'initial', spec: '98.0%-102.0%' },
            residueOnIgnition: { label: 'Residue on Ignition', value: '', unit: '%', status: 'initial', spec: 'NMT 0.1%' },
            ureaRelatedCompoundA: { label: 'Urea Related Compound A', value: '--', unit: '%', status: 'initial', spec: 'NMT 0.1%' },
            anyUnspecifiedImpurity: { label: 'Any Individual Unspecified Impurity', value: '--', unit: '%', status: 'initial', spec: 'NMT 0.1%' },
            totalImpurities: { label: 'Total Impurities', value: '', unit: '%', status: 'initial', spec: 'NMT 2.0%' }, // This is a sum, will be handled differently
            alcoholInsoluble: { label: 'Alcohol-Insoluble Matter', value: '', unit: '%', status: 'initial', spec: 'NMT 2 mg (0.04%)' },
            sterilityTests: { label: 'Sterility Tests', value: '', unit: '', status: 'initial', spec: 'Meets requirements' },
            bacterialEndotoxins: { label: 'Bacterial Endotoxins Test', value: '', unit: '', status: 'initial', spec: 'NMT 0.003 USP Endotoxin Units/mg' },
        };

        // Function to update the COA tab content dynamically
        function updateCOATab() {
            const coaResultsTableBody = document.getElementById('coa-results-table-body');
            if (!coaResultsTableBody) return;

            coaResultsTableBody.innerHTML = '';

            for (const key in calculationResults) {
                if (calculationResults.hasOwnProperty(key)) {
                    const resultData = calculationResults[key];
                    const tableRow = document.createElement('tr');
                    let valueContent;
                    let valueClass = '';

                    if (resultData.status === 'initial' || resultData.status === 'user-entered') {
                        valueContent = resultData.value;
                        valueClass = 'text-gray-700';
                    } else if (resultData.status === 'error') {
                        valueContent = resultData.value + resultData.unit;
                        valueClass = 'text-red-500';
                    } else { // 'calculated'
                        valueContent = resultData.value + resultData.unit;
                        valueClass = 'text-blue-700';
                    }

                    tableRow.innerHTML = `
                        <td class="py-2 px-3" style="direction: ltr; text-align: left;">${resultData.label}</td>
                        <td class="py-2 px-3" style="direction: ltr; text-align: left;">${resultData.spec}</td>
                        <td class="py-2 px-3 font-bold ${valueClass}">
                            <span style="display: inline-block; width: 100%; text-align: left;">
                                ${valueContent}
                            </span>
                        </td>
                    `;
                    coaResultsTableBody.appendChild(tableRow);
                }
            }
        }

        // Function to update user-entered impurity results
        window.updateCOAImpurityResult = function(key, value) {
            calculationResults[key].value = value;
            calculationResults[key].status = 'user-entered';
            updateCOATab();
        };

        // Helper function to update a specific calculation result and then the COA tab
        function setCalculationResult(key, value, unit = '', status = 'calculated', spec = null) {
            calculationResults[key].value = value;
            calculationResults[key].unit = unit;
            calculationResults[key].status = status;
            if (spec !== null) {
                calculationResults[key].spec = spec;
            }
            updateCOATab();
        }

        // Calculation function for Urea Assay
        window.calculateUreaAssay = function() {
            const ru = parseFloat(document.getElementById('ureaRu').value);
            const rs = parseFloat(document.getElementById('ureaRs').value);
            const Cs = parseFloat(document.getElementById('ureaCs').value);
            const Cu = parseFloat(document.getElementById('ureaCu').value);
            const resultElement = document.getElementById('ureaAssayResult');

            if (isNaN(ru) || isNaN(rs) || isNaN(Cs) || isNaN(Cu)) {
                resultElement.textContent = "Error: Please fill all fields with valid numbers.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('ureaAssay', 'Error', '', 'error');
                return;
            }
            if (rs === 0 || Cu === 0) {
                resultElement.textContent = "Error: rs and Cu cannot be zero.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('ureaAssay', 'Error', '', 'error');
                return;
            }

            const result = (ru / rs) * (Cs / Cu) * 100;
            resultElement.textContent = result.toFixed(2) + '%';
            resultElement.classList.remove('text-red-500');
            resultElement.classList.add('text-blue-700');

            setCalculationResult('ureaAssay', result.toFixed(2), '%', 'calculated', '98.0%-102.0%');
        };

        // Calculation for Urea Related Compound A
        window.calculateUreaRelatedCompoundA = function() {
            const ru = parseFloat(document.getElementById('ureaRelatedRu').value);
            const rs = parseFloat(document.getElementById('ureaRelatedRs').value);
            const Cs = parseFloat(document.getElementById('ureaRelatedCs').value);
            const Cu = parseFloat(document.getElementById('ureaRelatedCu').value);
            const resultElement = document.getElementById('ureaRelatedResult');

            if (isNaN(ru) || isNaN(rs) || isNaN(Cs) || isNaN(Cu)) {
                resultElement.textContent = "Error: Please fill all fields with valid numbers.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('ureaRelatedCompoundA', 'Error', '', 'error');
                return;
            }
            if (rs === 0 || Cu === 0) {
                resultElement.textContent = "Error: rs and Cu cannot be zero.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('ureaRelatedCompoundA', 'Error', '', 'error');
                return;
            }

            const result = (ru / rs) * (Cs / Cu) * 100;
            resultElement.textContent = result.toFixed(2) + '%';
            resultElement.classList.remove('text-red-500');
            resultElement.classList.add('text-blue-700');

            setCalculationResult('ureaRelatedCompoundA', result.toFixed(2), '%', 'calculated', 'NMT 0.1%');
        };

        // Calculation for Any Individual Unspecified Impurity
        window.calculateUnspecifiedImpurity = function() {
            const ru = parseFloat(document.getElementById('unspecifiedRu').value);
            const rs = parseFloat(document.getElementById('unspecifiedRs').value);
            const Cs = parseFloat(document.getElementById('unspecifiedCs').value);
            const Cu = parseFloat(document.getElementById('unspecifiedCu').value);
            const resultElement = document.getElementById('unspecifiedImpurityResult');

            if (isNaN(ru) || isNaN(rs) || isNaN(Cs) || isNaN(Cu)) {
                resultElement.textContent = "Error: Please fill all fields with valid numbers.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('anyUnspecifiedImpurity', 'Error', '', 'error');
                return;
            }
            if (rs === 0 || Cu === 0) {
                resultElement.textContent = "Error: rs and Cu cannot be zero.";
                resultElement.classList.remove('text-blue-700');
                resultElement.classList.add('text-red-500');
                setCalculationResult('anyUnspecifiedImpurity', 'Error', '', 'error');
                return;
            }

            const result = (ru / rs) * (Cs / Cu) * 100;
            resultElement.textContent = result.toFixed(2) + '%';
            resultElement.classList.remove('text-red-500');
            resultElement.classList.add('text-blue-700');

            setCalculationResult('anyUnspecifiedImpurity', result.toFixed(2), '%', 'calculated', 'NMT 0.1%');
        };


        // Function to export COA as a PDF
        window.exportCOAPDF = function() {
            const element = document.getElementById('coa-content-to-pdf');
            const exportButton = element.querySelector('button');

            if (exportButton) {
                exportButton.style.display = 'none';
            }

            document.fonts.ready().then(() => {
                html2canvas(element, {
                    scale: 3,
                    logging: true,
                    useCORS: true,
                }).then(function(canvas) {
                    const imgData = canvas.toDataURL('image/png');
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4');

                    const imgWidth = 210;
                    const pageHeight = 297;
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;

                    let position = 0;

                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;

                    while (heightLeft >= 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }

                    pdf.save(`COA_Urea_${new Date().toISOString().slice(0, 10)}.pdf`);

                }).catch(error => {
                    console.error("Error capturing screenshot or generating PDF:", error);
                    alert("Error capturing screenshot or generating PDF: " + error.message);
                }).finally(() => {
                    if (exportButton) {
                        exportButton.style.display = '';
                    }
                });
            }).catch(error => {
                console.error("Font loading error:", error);
                alert("Font loading error. PDF may not display correctly.");
                if (exportButton) {
                    exportButton.style.display = '';
                }
            });
        };

        document.addEventListener('DOMContentLoaded', function () {
            const mainTabButtons = document.querySelectorAll('nav .tab-button');
            const mainTabContents = document.querySelectorAll('main > .tab-content');

            mainTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    mainTabButtons.forEach(btn => {
                        btn.classList.remove('tab-active');
                        btn.classList.add('tab-inactive');
                    });
                    this.classList.add('tab-active');
                    this.classList.remove('tab-inactive');

                    mainTabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(this.dataset.tab).classList.remove('hidden');

                    if (typeof MathJax !== 'undefined') {
                        MathJax.typeset([document.getElementById(this.dataset.tab)]);
                    }

                    if (this.dataset.tab === 'coa') {
                        updateCOATab();
                    }
                });
            });

            if (typeof MathJax !== 'undefined') {
                MathJax.typeset([document.getElementById('definition')]);
            }

            updateCOATab();
        });
    </script>
</body>
</html>
